(function(t){function e(e){for(var n,i,s=e[0],c=e[1],l=e[2],d=0,m=[];d<s.length;d++)i=s[d],o[i]&&m.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(m.length)m.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,s=1;s<a.length;s++){var c=a[s];0!==o[c]&&(n=!1)}n&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},o={app:0},r=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"067d":function(t,e,a){},1:function(t,e){},2:function(t,e){},"4f39":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("6762"),a("2fdb"),a("cadf"),a("551c"),a("097d"),a("54ba");var n=a("2b0e"),o=a("bb71");a("da64");n["a"].use(o["a"],{iconfont:"md"});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("router-view")],1)},i=[],s=(new n["a"],{name:"App",data:function(){return{authenticated:!1,email:null}},methods:{setAuthenticated:function(t,e){localStorage.auth=t,this.authenticated=!0,this.email=e},mounted:function(){try{this.token=localStorage.getItem("b_token")}catch(t){}}}}),c=s,l=a("2877"),u=a("6544"),d=a.n(u),m=a("7496"),v=Object(l["a"])(c,r,i,!1,null,null,null);v.options.__file="App.vue";var p=v.exports;d()(v,{VApp:m["a"]});var h=a("8c4f"),f=a("2f62"),g=a("bc3a"),_=a.n(g),b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{attrs:{id:"inspire"}},[a("v-toolbar",{attrs:{color:"blue-grey",dark:"",fixed:"",app:""}},[a("v-toolbar-side-icon"),a("v-toolbar-title",[t._v("Toolbar")]),a("v-spacer"),a("v-toolbar-side-icon")],1),a("v-content",[a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"",md2:""}},[a("Rooms",{on:{show_room:t.createChat}}),a("Players",{attrs:{players:t.players}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-card",{staticClass:"card-height",attrs:{dark:"",tile:"",flat:"",color:""}},[a("v-toolbar-title",[t._v("Team Video Feed")]),a("v-card-text",[t.video_room_loading?a("v-progress-circular",{staticClass:"video-loading",attrs:{size:70,width:7,indeterminate:""}}):a("div",{attrs:{id:"team-video"}},[a("div",{attrs:{id:"local-video"}})])],1)],1),a("ChatRoom",{attrs:{messages:t.chat_messages,chat_loading:t.chat_loading,email:t.logged_user_email},on:{"new-message":t.addMessage}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-card",{staticClass:"card-height",attrs:{dark:"",tile:"",flat:"",color:"red darken-4"}},[a("v-toolbar-title",[t._v("Master Video Feed")]),a("v-card-text",[a("div",{attrs:{id:"master-video"}})])],1),a("v-card",{staticClass:"card-height",attrs:{dark:"",tile:"",flat:"",color:"red darken-4"}},[a("v-toolbar-title",[t._v("Game Play")]),a("v-card-text",[t.video_room_loading?a("v-progress-circular",{staticClass:"video-loading",attrs:{size:70,width:7,indeterminate:""}}):a("span",[t._v(" %444 ")])],1)],1)],1)],1)],1)],1),a("v-navigation-drawer",{attrs:{right:"",temporary:"",fixed:""}}),a("Footer")],1)},k=[],y=(a("5df3"),a("1c4c"),a("ac6a"),a("96cf"),a("1da1")),T=a("be94"),x=a("de1e"),V=a.n(x),w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"card-margin-bottom"},[a("v-toolbar",{attrs:{color:"orange lighten-1",dark:""}},[a("v-toolbar-title",[t._v("Team")])],1),a("v-list",{attrs:{"two-line":""}},[t._l(t.rooms,function(e,n){return[a("v-list-tile",{key:n,class:t.active_room==e.name?"nav-active":"",attrs:{avatar:"",ripple:""},on:{click:function(a){t.showRoom(e.name)}}},[a("v-list-tile-avatar",[a("img",{attrs:{src:e.avatar}})]),a("v-list-tile-content",[a("v-list-tile-title",[t._v(t._s(e.name))]),a("v-list-tile-sub-title",[t._v(t._s(e.name))])],1)],1)]})],2)],1)},C=[],L={name:"Rooms",data:function(){return{active_room:null,rooms:[{id:1,name:"The Winners",avatar:"https://picsum.photos/250/300?image=783"},{id:2,name:"Remote Control",avatar:"https://picsum.photos/250/300?image=783"},{id:3,name:"Team Fabulous",avatar:"https://picsum.photos/250/300?image=783"},{id:4,name:"Slow Down",avatar:"https://picsum.photos/250/300?image=783"}],roomCount:4,loading:!1}},methods:{showRoom:function(t){this.active_room=t,this.$emit("show_room",t)}}},R=L,S=(a("68b4"),a("b0af")),A=a("8860"),E=a("ba95"),j=a("c954"),O=a("5d23"),P=a("71d9"),I=a("2a7f"),$=Object(l["a"])(R,w,C,!1,null,"0634b638",null);$.options.__file="Rooms.vue";var U=$.exports;d()($,{VCard:S["a"],VList:A["a"],VListTile:E["a"],VListTileAvatar:j["a"],VListTileContent:O["a"],VListTileSubTitle:O["b"],VListTileTitle:O["c"],VToolbar:P["a"],VToolbarTitle:I["a"]});var F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"card-margin-bottom"},[a("v-toolbar",{attrs:{color:"orange lighten-1",dark:""}},[a("v-toolbar-title",[t._v("Players")])],1),a("v-list",{attrs:{"two-line":""}},[t._l(t.players,function(e,n){return[a("v-list-tile",{key:n,attrs:{avatar:"",ripple:""}},[a("v-list-tile-avatar",[a("img",{attrs:{src:"https://picsum.photos/250/300?image=783'"}})]),a("v-list-tile-content",[a("v-list-tile-title",[t._v(t._s(e.first_name)+" "+t._s(e.last_name))]),a("v-list-tile-sub-title",[t._v(t._s(e.first_name)+" "+t._s(e.last_name))])],1)],1)]})],2)],1)},M=[],B={name:"Players",props:{players:Array},data:function(){return{loading:!1}},methods:{}},D=B,z=(a("bbe7"),Object(l["a"])(D,F,M,!1,null,"5c5008cf",null));z.options.__file="Players.vue";var J=z.exports;d()(z,{VCard:S["a"],VList:A["a"],VListTile:E["a"],VListTileAvatar:j["a"],VListTileContent:O["a"],VListTileSubTitle:O["b"],VListTileTitle:O["c"],VToolbar:P["a"],VToolbarTitle:I["a"]});var N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-footer",{attrs:{dark:"",height:"auto"}},[a("v-card",{staticClass:"indigo lighten-1 white--text text-xs-center",attrs:{flat:"",tile:""}},[a("v-card-text",[a("v-btn",{staticClass:"mx-3 white--text",attrs:{icon:""}},[a("v-icon",{attrs:{size:"24px"}})],1)],1),a("v-card-text",{staticClass:"white--text pt-0"},[t._v("\n      Phasellus feugiat arcu sapien, et iaculis ipsum elementum sit amet. Mauris cursus commodo interdum. Praesent ut risus eget metus luctus accumsan id ultrices nunc. Sed at orci sed massa consectetur dignissim a sit amet dui. Duis commodo vitae velit et faucibus. Morbi vehicula lacinia malesuada. Nulla placerat augue vel ipsum ultrices, cursus iaculis dui sollicitudin. Vestibulum eu ipsum vel diam elementum tempor vel ut orci. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.\n    ")]),a("v-divider"),a("v-card-text",{staticClass:"white--text"},[t._v("\n      ©2018 — "),a("strong",[t._v("Vuetify")])])],1)],1)},q=[],G={name:"Footer"},H=G,W=(a("760c"),a("8336")),K=a("99d9"),Q=a("ce7e6"),X=a("553a"),Y=a("132d"),Z=Object(l["a"])(H,N,q,!1,null,null,null);Z.options.__file="Footer.vue";var tt=Z.exports;d()(Z,{VBtn:W["a"],VCard:S["a"],VCardText:K["b"],VDivider:Q["a"],VFooter:X["a"],VIcon:Y["a"]});var et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"card-height",attrs:{dark:"",tile:"",flat:"",color:""}},[a("v-toolbar-title",[t._v("Ragamuffings Chat")]),t.chat_loading?a("v-progress-circular",{staticClass:"chat-loading",attrs:{size:70,width:7,indeterminate:""}}):a("div",[a("v-card-text",{attrs:{id:"messages"}},t._l(t.messages,function(e,n){return a("div",{key:n,staticClass:"chat-message",class:e.author==t.email?"right":""},[a("v-list-tile-avatar",{staticClass:"circle"},[a("img",{attrs:{src:"https://picsum.photos/250/300?image=783"}})]),t._v("\n                "+t._s(e.body)+"\n            ")],1)}),0),a("v-container",{staticClass:"input-form",attrs:{fluid:"","grid-list-md":"","text-xs-center":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",md12:""}},[a("v-textarea",{attrs:{box:"",label:"message",rows:"1",width:"50px"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1),a("button",{staticStyle:{"margin-left":"-30px","z-index":"3"},attrs:{type:"submit"}},[a("i",{staticClass:"material-icons",on:{click:function(e){t.sendMessage(t.message)}}},[t._v("send")])])],1)],1)],1)],1)},at=[],nt={name:"ChatRoom",props:{email:String,messages:Array,chat_loading:Boolean},data:function(){return{message:""}},methods:{sendMessage:function(t){this.message="",this.$emit("new-message",t)}},created:function(){}},ot=nt,rt=(a("6028"),a("a523")),it=a("0e8f"),st=a("a722"),ct=a("490a"),lt=a("a844"),ut=Object(l["a"])(ot,et,at,!1,null,null,null);ut.options.__file="ChatRoom.vue";var dt=ut.exports;d()(ut,{VCard:S["a"],VCardText:K["b"],VContainer:rt["a"],VFlex:it["a"],VLayout:st["a"],VListTileAvatar:j["a"],VProgressCircular:ct["a"],VTextarea:lt["a"],VToolbarTitle:I["a"]});var mt=a("dd8f"),vt={name:"App",components:{Rooms:U,Footer:tt,ChatRoom:dt,Players:J},data:function(){return{chat:null,video_room_loading:!1,chat_loading:!1,active_room:null,video_client:null,room_name:null,chat_client:null,chat_channel:null,chat_messages:[],twilio_access_token:null,players:[]}},created:function(){window.addEventListener("beforeunload",this.leaveRoomIfJoined)},computed:Object(T["a"])({},Object(f["c"])({logged_user_email:function(t){return t.logged_user_email},token:function(t){return t.token},role:function(t){return t.role}})),methods:{getAccessToken:function(){var t=Object(y["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.twilio_access_token){t.next=2;break}return t.abrupt("return",new Promise(function(t,a){t({data:{token:e.twilio_access_token}})}));case 2:return t.next=4,this.$http.post("/api/generate_video_token",{identity:this.logged_user_email});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),attachTracks:function(t,e){t.forEach(function(t){e.appendChild(t.attach())})},attachParticipantTracks:function(t,e){var a=Array.from(t.tracks.values());this.attachTracks(a,e)},detachTracks:function(t){t.forEach(function(t){t.detach().forEach(function(t){t.remove()})})},detachParticipantTracks:function(t){var e=Array.from(t.tracks.values());this.detachTracks(e)},leaveRoomIfJoined:function(){this.active_room&&this.active_room.disconnect()},createChat:function(t){var e=this;this.loading=!0,this.facilitatorRoom(),this.getAccessToken().then(function(a){if(200==a.status){e.video_room_loading=!0,e.chat_loading=!0,e.room_name=null;var n=a.data.token;e.twilio_access_token=n;var o={name:t,audio:!0,video:{width:150,height:150}};e.leaveRoomIfJoined(),document.getElementById("team-video").innerHTML="",mt.Client.create(n).then(function(a){a.getPublicChannelDescriptors().then(function(t){}),e.chat_client=a,e.addChannel(t),e.chat_loading=!1}),V.a.connect(n,o).then(function(a){e.active_room=a,e.room_name=t,e.video_room_loading=!1,a.participants.forEach(function(t){e.$http.get("/api/get_user_details?email=".concat(t.identity)).then(function(t){e.players.push(t.data.user)});var a=document.getElementById("team-video");e.attachParticipantTracks(t,a)}),a.on("trackSubscribed",function(t,a){e.$http.get("/api/get_user_details?email=".concat(a.identity)).then(function(t){e.players.push(t.data.user)});var n=document.getElementById("team-video");e.attachTracks([t],n)}),a.on("trackUnsubscribed",function(t,a){e.detachTracks([t])}),a.on("participantDisconnected",function(t){e.players=e.players.filter(function(e){return e.email!=t.identity}),e.detachParticipantTracks(t)}),V.a.createLocalVideoTrack().then(function(t){var a=document.getElementById("local-video");a.appendChild(t.attach()),e.localTrack=!0})},function(t){console.error("Unable to connect to Room: "+t.message)})}})},facilitatorRoom:function(){var t=this;this.getAccessToken().then(function(e){var a={name:"facilltator-room",audio:!0,video:{width:120,height:120}};t.localTrack||"facilitator"!=t.role||V.a.createLocalVideoTrack().then(function(t){var e=document.getElementById("master-video");e.appendChild(t.attach())}),V.a.connect(e.data.token,a).then(function(e){e.participants.forEach(function(e){t.$http.get("/api/get_user_details?email=".concat(e.identity)).then(function(a){if("facilitator"!=a.data.role){var n=document.getElementById("master-video");t.attachParticipantTracks(e,n)}})})},function(t){console.error("Unable to connect to Room: "+t.message)})})},setupChannel:function(){var t=Object(y["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.chat_channel=e,e.decline().then(function(t){t.join().then(function(t){t.getMessages().then(function(t){a.chat_messages=t.items}),t.on("messageAdded",function(t){a.chat_messages.push(t.state)})}).catch(function(e){t.on("messageAdded",function(t){a.chat_messages.push(t.state)}),t.getMessages().then(function(t){a.chat_messages=t.items})})});case 2:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),addMessage:function(t){this.chat_channel&&this.chat_channel.sendMessage(t)},addChannel:function(){var t=Object(y["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.chat_client.createChannel({uniqueName:e}).then(function(t){return a.setupChannel(t)}).catch(function(t){a.chat_client.getChannelByUniqueName(e).then(function(t){return a.setupChannel(t)}).catch(function(t){return console.log(t.message)})});case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}},pt=vt,ht=(a("992a"),a("549c")),ft=a("f774"),gt=a("9910"),_t=a("706c"),bt=Object(l["a"])(pt,b,k,!1,null,"e2507914",null);bt.options.__file="Dashboard.vue";var kt=bt.exports;d()(bt,{VApp:m["a"],VCard:S["a"],VCardText:K["b"],VContainer:rt["a"],VContent:ht["a"],VFlex:it["a"],VLayout:st["a"],VNavigationDrawer:ft["a"],VProgressCircular:ct["a"],VSpacer:gt["a"],VToolbar:P["a"],VToolbarSideIcon:_t["a"],VToolbarTitle:I["a"]});var yt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{attrs:{id:"inspire"}},[a("v-content",[a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[a("v-card",{staticClass:"elevation-12"},[a("v-toolbar",{attrs:{dark:"",color:"primary"}},[a("v-toolbar-title",[t._v("Login form")])],1),a("v-card-text",[a("v-form",[a("v-text-field",{attrs:{"prepend-icon":"person",label:"email",type:"text"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),a("v-text-field",{attrs:{id:"password","prepend-icon":"lock",label:"Password",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)],1)],1)],1)},Tt=[],xt={data:function(){return{email:"",password:"",loading:!1}},props:{source:String},methods:Object(T["a"])({login:function(){var t=this;this.loading=!0,this.$http.post("/api/login",{email:this.email,password:this.password}).then(function(e){if("success"==e.data.status){var a=e.data.access_token,n=e.data.user_data;t.proccessing=!1,t.updateUserRole(n.role),t.updateAccessToken(a),t.updateLoggedUserEmail(t.email),t.$router.push("/")}else t.message="Login Faild, try again"}).catch(function(e){t.message="Login Faild, try again",t.proccessing=!1})}},Object(f["b"])({updateLoggedUserEmail:"updateLoggedUserEmail",updateUserRole:"updateUserRole",updateAccessToken:"updateAccessToken"})),created:function(){}},Vt=xt,wt=a("4bd4"),Ct=a("2677"),Lt=Object(l["a"])(Vt,yt,Tt,!1,null,null,null);Lt.options.__file="Login.vue";var Rt=Lt.exports;d()(Lt,{VApp:m["a"],VBtn:W["a"],VCard:S["a"],VCardActions:K["a"],VCardText:K["b"],VContainer:rt["a"],VContent:ht["a"],VFlex:it["a"],VForm:wt["a"],VLayout:st["a"],VSpacer:gt["a"],VTextField:Ct["a"],VToolbar:P["a"],VToolbarTitle:I["a"]});var St=[{path:"/",component:kt},{path:"/login",component:Rt}],At=["/login"],Et={updateAccessToken:function(t,e){var a=t.commit;localStorage.token=e,a("updateAccessToken",e)},updateLoggedUserEmail:function(t,e){var a=t.commit;localStorage.logged_user_email=e,a("updateLoggedUserEmail",e)},updateUserRole:function(t,e){var a=t.commit;localStorage.role=e,a("updateUserRole",e)}},jt={updateAccessToken:function(t,e){t.token=e},updateLoggedUserEmail:function(t,e){t.logged_user_email=e},updateUserRole:function(t,e){t.role=e}},Ot={token:localStorage.getItem("token")||null,role:localStorage.getItem("role")||null,logged_user_email:localStorage.getItem("logged_user_email")||null},Pt={state:Ot,mutations:jt,actions:Et};n["a"].config.productionTip=!1,n["a"].use(h["a"]),n["a"].use(f["a"]),n["a"].prototype.$http=_.a;var It=new h["a"]({routes:St}),$t=new f["a"].Store(Pt);It.beforeEach(function(t,e,a){if(!At.includes(t.path)&&(!localStorage.getItem("token")||!localStorage.getItem("logged_user_email")))return localStorage.removeItem("token"),localStorage.removeItem("logged_user_email"),a("/login");a()}),new n["a"]({render:function(t){return t(p)},router:It,store:$t}).$mount("#app")},"59ed":function(t,e,a){},6028:function(t,e,a){"use strict";var n=a("59ed"),o=a.n(n);o.a},"68b4":function(t,e,a){"use strict";var n=a("8bf5"),o=a.n(n);o.a},"760c":function(t,e,a){"use strict";var n=a("93ff"),o=a.n(n);o.a},"8bf5":function(t,e,a){},"93ff":function(t,e,a){},"992a":function(t,e,a){"use strict";var n=a("4f39"),o=a.n(n);o.a},bbe7:function(t,e,a){"use strict";var n=a("067d"),o=a.n(n);o.a}});
//# sourceMappingURL=app.94308ebb.js.map